---
description: "プロジェクト共通ポリシーと標準"
alwaysApply: true
---

<!-- AUTO-GENERATED FILE. DO NOT EDIT DIRECTLY. -->
<!-- source: docs/ai/canonical/* + scripts/sync_ai_context.py -->

# グローバルポリシー

- 本リポジトリの AI 運用は「正本を1箇所に集約し、生成先へ配布する」方式を採用する。
- ルール更新時は `docs/ai/canonical/` を編集し、生成ファイルは直接編集しない。
- タスク開始時は必ずタスク設計を作成し、承認後に実装する。
- 既存の実装・ドキュメントとの整合を保ち、変更理由を記録する。
- ユーザーとのコミュニケーションは日本語で行う。
- CI は必須とし、品質ゲートの不一致を許容しない。
- `README.md` は人間向けの入口として、目的・全体像・セットアップ・利用導線を記載する。
- `AGENTS.md` はエージェント向け実行規約として、判断基準・編集制約・検証手順・タスクルーティングを記載する。
- エージェント実行の詳細手順は `README.md` に重複記載しない。必要な場合は `AGENTS.md` と `docs/ai/playbooks/*.md` へリンクする。
- 記載先に迷った場合は「人が最初に理解するための説明は README、エージェントが実行時に守る規約は AGENTS」を優先する。

# コーディング標準

## 設計

- SOLID と DRY を基本原則にする。
- Hexagonal Architecture を採用し、`adapters/application/domain/ports` の責務を分離する。
- 依存方向は外側から内側へ固定し、domain は外部技術へ依存しない。

## Python

- Python 3.12+ を前提にする。
- 型ヒントを必須にし、`mypy` で検証する。
- `ruff` で format/lint を統一する。
- docstring は日本語で簡潔に書く。

## 環境変数

- `.env.development` / `.env.production` を利用する。
- 秘密情報は dotenvx の `encrypted:` 形式で管理する。
- `.env.keys` はコミットしない。
